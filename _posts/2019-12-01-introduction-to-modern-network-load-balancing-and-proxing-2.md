---
layout: post
title: 최신 네트워크 로드 밸런싱 및 프록시 - 로드 밸런서 토폴로지 Introduction to modern network load balancing and proxing #2 - load balancer topologies
tags: [번역, 로드밸런서, 토폴로지]
---

[Introduction to modern network load balancing and proxing](https://blog.envoyproxy.io/introduction-to-modern-network-load-balancing-and-proxying-a57f6ff80236)

## 로드 밸런서 토폴로지 종류
이제로드 밸런서가 무엇인지, L4와 L7로드 밸런서의 차이점 및로드 밸런서 기능을 간략하게 살펴 봤으므로로드 밸런서가 배포되는 다양한 분산 시스템 토폴로지로 넘어간다. (다음 토폴로지 각각은 L4 및 L7로드 밸런서 모두에 적용 가능하다).


### 미들 프록시

![Figure 4](/images/posts/figure4-middle-proxy-load-balancing-topology.png)

그림 4에 표시된 미들 프록시 토폴로지는 대부분의 독자에게 가장 익숙한 로드 밸런싱 방법이다. 이 안에는 Cisco, Juniper, F5 등의 하드웨어 장치가 포함된다. Amazon의 ALB 및 NLB 및 Google의 Cloud Load Balancer와 같은 클라우드 소프트웨어 솔루션; HAProxy, NGINX 및 Envoy와 같은 순수한 소프트웨어 자체 호스팅 솔루션도 포함된다. 미들 프록시 솔루션의 장점은 사용자 단순성이다. 일반적으로 사용자는 DNS를 통해로드 밸런서에 연결하므로 다른 것에 대해 걱정할 필요가 없다. 미들 프록시 솔루션의 단점은 프록시 (클러스터 화 된 경우에도)가 단일 장애 지점이자 스케일링 병목 현상이라는 사실이다. 미들 프록시는 종종 작업을 어렵게하는 블랙 박스다. 클라이언트, 실제 네트워크, 중간, 백엔드 에서 관찰된 문제점이 어디 있는지 말하기 어렵게 할 수 있다.

### 엣지 프록시

![Figure 5](/images/posts/fitgure5-edge-proxy-load-balancing-topology.png)

그림 5에 표시된 에지 프록시 토폴로지는 실제로 인터넷을 통해 로드 밸런서에 액세스 할 수있는 미들 프록시 토폴로지의 변형이다. 이 시나리오에서 로드 밸런서는 일반적으로 TLS 종료, 속도 제한, 인증 및 정교한 트래픽 라우팅과 같은 추가 "API 게이트웨이”기능을 제공해야 한다. Edge 프록시의 장단점은 미들 프록시와 동일하다. 단점은 일반적으로 대규모 인터넷 연결 분산 시스템에 전용 Edge 프록시를 배포하는 것이 불가피하다는 것이다. 클라이언트는 일반적으로 서비스 소유자가 제어하지 않는 임의의 네트워크 라이브러리를 사용하여 DNS를 통해 시스템에 엑세스 해야한다 (다음 섹션에 설명 된 내장 클라이언트 라이브러리 또는 사이드카 프록시 토폴로지를 클라이언트에서 직접 실행하는 것은 비현실적 임). 또한 보안상의 이유로 모든 인터넷 연결 트래픽이 시스템으로 유입되는 단일 게이트웨이를 갖는 것이 바람직하다.

### 임베디드 클라이언트 라이브러리

![Figure 6](/images/posts/figure6-load-balancing-via-embedded-client-library.png)

미들 프록시 토폴로지에 내재 된 단일 장애 지점 및 확장 문제를 피하기 위해 그림 6과 같이보다 정교한 인프라가 라이브러리를 통해 로드 밸런서를 서비스에 직접 포함시키는 방향으로 이동했다. 라이브러리는 지원되는 기능이 매우 다양하지만 일부는 이 카테고리에서 가장 잘 알려지고 기능이 풍부한 기능은 Finagle, Eureka / Ribbon / Hystrix 및 gRPC이다 (실제로 Stubby라고하는 내부 Google 시스템을 기반으로 함). 라이브러리 기반 솔루션의 주요 장점은로드 밸런서의 모든 기능을 각 클라이언트에 완전히 분배하여 앞에서 설명한 단일 실패 지점 및 확장 문제를 제거한다는 것이다. 라이브러리 기반 솔루션의 주요 단점은 조직이 사용하는 모든 언어로 라이브러리를 구현해야한다는 사실이다. 분산 아키텍처는 점점 더 "다국어"(다국어)가되고 있다. 이 환경에서는 여러 언어로 된 매우 정교한 네트워킹 라이브러리를 다시 구현하는 비용이 엄청날 수 있다. 마지막으로, 대규모 서비스 아키텍처에서 라이브러리 업그레이드를 배포하는 것은 매우 어려울 수 있으므로 많은 다른 버전의 라이브러리가 프로덕션 환경에서 동시에 실행되어 운영인지 부하가 ​​증가 할 가능성이 높다.
위에서 말한 것처럼, 위에서 언급 한 라이브러리는 프로그래밍 언어 확산을 제한하고 라이브러리 업그레이드 문제를 극복 할 수있는 회사에 성공적이다.

### 사이드카 프록시

![Figure 7](/images/posts/figure7-load-balancing-via-sidecar-proxy.png)

임베디드 클라이언트 라이브러리로드 밸런서 토폴로지의 변형은 그림 7에 표시된 사이드카 프록시 토폴로지이다. 최근에 이 토폴로지는 "서비스 메시”로 대중화됐다. 사이드카 프록시의 기본 개념은 약간의 비용이 든다는 것이다. 다른 프로세스로의 호핑을 통한 대기 시간 위약금은 프로그래밍 언어 잠금없이 내장 라이브러리 접근 방식의 모든 이점을 얻을 수 있다. 이 글을 쓰는 시점에서 가장 많이 사용되는 사이드카 프록시로드 밸런서는 Envoy, NGINX, HAProxy 및 Linkerd입니다. 사이드카 프록시 접근 방식에 대한 자세한 내용은 Envoy를 소개하는 블로그 게시물과 서비스 메시 데이터 플레인 대 컨트롤 플레인에 대한 내 게시물을 참고하자.

### 다양한 로드 밸런서 토폴로지의 요약 및 장단점
* 미들 프록시 토폴로지는 일반적으로 가장 쉬운로드 밸런싱 토폴로지이다. 단일 장애 지점, 스케일링 제한 및 블랙 박스 작동으로 인해 부족합니다.
* Edge 프록시 토폴로지는 미들 프록시와 유사하지만 일반적으로 피할 수 없다.
* 내장 된 클라이언트 라이브러리 토폴로지는 최상의 성능과 확장 성을 제공하지만 모든 서비스에서 라이브러리를 업그레이드해야 할뿐만 아니라 모든 언어로 라이브러리를 구현해야 한다.
* 사이드카 프록시 토폴로지는 내장 클라이언트 라이브러리 토폴로지만큼 성능이 좋지 않지만 제한 사항이 없다.
전반적으로, 사이드카 프록시 토폴로지 (서비스 메시)는 점차 서비스 간 통신을 위한 다른 모든 토폴로지를 대체 할 것으로 생각한다. 트래픽이 서비스 메시에 들어가기 전에 항상 에지 프록시 토폴로지가 필요하다.


* 토폴로지 (topology)  : 컴퓨터 네트워크 요소(링크, 노드)를 물리적으로 연결해 놓은 것, 또는 그 연결방식을 의미함
